SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

PRINT 'Testing [$(owner)].[STIsCCW]...'
GO

with data as (
  SELECT geometry::STGeomFromText('POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0), (1 1, 1 9, 9 9, 9 1, 1 1))',0) as polygon
)
select 'Exterior' as test, [$(owner)].[STisCCW](d.polygon.STExteriorRing()) as isCCW from data  d
union all
select 'Interior' as test, [$(owner)].[STisCCW](d.polygon.STInteriorRingN(1)) as isCCW from data as d;
GO

SELECT [$(owner)].[STisCCW] ( geometry::STGeomFromText('LINESTRING (63.29 914.361, 73.036 899.855, 80.023 897.179, 79.425 902.707, 91.228 903.305, 79.735 888.304, 98.4 883.584, 115.73 903.305, 102.284 923.026, 99.147 899.271, 110.8 902.707, 90.78 887.02, 96.607 926.911, 95.71 926.313, 95.412 928.554, 101.238 929.002, 119.017 922.279,63.29 914.361)',0) ) as isCCW;
GO

SELECT [$(owner)].[STisCCW] ([$(owner)].[STReverse](geometry::STGeomFromText('LINESTRING (63.29 914.361, 73.036 899.855, 80.023 897.179, 79.425 902.707, 91.228 903.305, 79.735 888.304, 98.4 883.584, 115.73 903.305, 102.284 923.026, 99.147 899.271, 110.8 902.707, 90.78 887.02, 96.607 926.911, 95.71 926.313, 95.412 928.554, 101.238 929.002, 119.017 922.279,63.29 914.361)',0),3,1)) as isCCW;
GO

select [$(owner)].[STisCCW](geometry::STGeomFromText('LINESTRING(148.04452460167477 -36.391801308813505, 148.04481426832533 -36.391801308813427, 148.04481426826769 -36.391881931347953, 148.04452460173229 -36.391881931347996, 148.04452460167477 -36.391801308813505)',4326));
GO

select [$(owner)].[STisCCW](geometry::STGeomFromText('LINESTRING(148.04452460167477 -36.391801308813505, 148.04452460173229 -36.391881931347996, 148.04481426826769 -36.391881931347953, 148.04481426832533 -36.391801308813427, 148.04452460167477 -36.391801308813505)',4326));
GO


